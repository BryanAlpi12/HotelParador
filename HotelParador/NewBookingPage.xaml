<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="HotelParador.NewBookingPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    Title="NewBookingPage">

    <Grid RowDefinitions="Auto,*,Auto">

        <!--  Header  -->
        <Grid Padding="20,50,20,20" BackgroundColor="#6200EA">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <ImageButton
                BackgroundColor="Transparent"
                Clicked="OnBackClicked"
                HeightRequest="24"
                Source="back_arrow.png"
                VerticalOptions="Center"
                WidthRequest="24" />

            <Label
                Grid.Column="1"
                Margin="15,0,0,0"
                FontAttributes="Bold"
                FontSize="20"
                Text="Nueva ReservaciÃ³n"
                TextColor="White"
                VerticalOptions="Center" />
        </Grid>

        <!--  Formulario  -->
        <ScrollView Grid.Row="1" Padding="20">
            <VerticalStackLayout Spacing="15">

                <!--  Seleccionar HabitaciÃ³n  -->
                <Frame
                    Padding="20"
                    BackgroundColor="White"
                    CornerRadius="15"
                    HasShadow="True">
                    <VerticalStackLayout Spacing="15">
                        <Label
                            FontAttributes="Bold"
                            FontSize="16"
                            Text="Selecciona una habitaciÃ³n"
                            TextColor="#333" />

                        <!--  ActivityIndicator mostrado mientras se cargan las habitaciones  -->
                        <HorizontalStackLayout Spacing="10" VerticalOptions="Center">
                            <ActivityIndicator
                                x:Name="RoomsLoadingIndicator"
                                HeightRequest="24"
                                IsRunning="False"
                                IsVisible="False"
                                WidthRequest="24"
                                Color="#6200EA" />
                            <Label
                                x:Name="RoomsLoadingLabel"
                                FontSize="12"
                                IsVisible="False"
                                Text="Cargando habitaciones..."
                                TextColor="#666"
                                VerticalOptions="Center" />
                        </HorizontalStackLayout>

                        <!--  Picker vacÃ­o en XAML; ItemsSource se establece desde el code-behind  -->
                        <Picker
                            x:Name="RoomPicker"
                            Title="Elige una habitaciÃ³n"
                            FontSize="14"
                            IsEnabled="False"
                            SelectedIndexChanged="OnRoomSelected" />

                        <!--  Preview de la habitaciÃ³n seleccionada  -->
                        <Frame
                            x:Name="RoomPreview"
                            Padding="10"
                            BackgroundColor="#F5F5F5"
                            CornerRadius="10"
                            HasShadow="False"
                            IsVisible="False">
                            <Grid ColumnDefinitions="80,*" ColumnSpacing="10">
                                <Image
                                    x:Name="RoomPreviewImage"
                                    Aspect="AspectFill"
                                    HeightRequest="80"
                                    Source="garden_room.jpg"
                                    WidthRequest="80" />
                                <VerticalStackLayout Grid.Column="1" Spacing="3">
                                    <Label
                                        x:Name="RoomPreviewName"
                                        FontAttributes="Bold"
                                        FontSize="14"
                                        Text="Garden Room"
                                        TextColor="#333" />
                                    <Label
                                        FontSize="12"
                                        Text="Vista al jardÃ­n tropical"
                                        TextColor="#666" />

                                    <HorizontalStackLayout Margin="0,3,0,0" Spacing="5">
                                        <Label FontSize="11" Text="ðŸ‘¥" />
                                        <Label
                                            x:Name="RoomCapacity"
                                            FontSize="11"
                                            Text="2 huÃ©spedes"
                                            TextColor="#666" />
                                        <Label
                                            Margin="3,0"
                                            Text="â€¢"
                                            TextColor="#999" />
                                        <Label FontSize="11" Text="ðŸ“" />
                                        <Label
                                            FontSize="11"
                                            Text="35 mÂ²"
                                            TextColor="#666" />
                                    </HorizontalStackLayout>
                                </VerticalStackLayout>
                            </Grid>
                        </Frame>
                    </VerticalStackLayout>
                </Frame>

                <!--  Fechas de estadÃ­a  -->
                <Frame
                    Padding="20"
                    BackgroundColor="White"
                    CornerRadius="15"
                    HasShadow="True">
                    <VerticalStackLayout Spacing="15">
                        <Label
                            FontAttributes="Bold"
                            FontSize="16"
                            Text="Fechas de estadÃ­a"
                            TextColor="#333" />

                        <!--  Check-in  -->
                        <VerticalStackLayout Spacing="5">
                            <Label
                                FontSize="14"
                                Text="Check-in"
                                TextColor="#666" />
                            <DatePicker
                                x:Name="CheckInPicker"
                                DateSelected="OnDateSelected"
                                FontSize="16"
                                Format="dd/MM/yyyy"
                                MinimumDate="11/25/2025" />
                        </VerticalStackLayout>

                        <!--  Check-out  -->
                        <VerticalStackLayout Spacing="5">
                            <Label
                                FontSize="14"
                                Text="Check-out"
                                TextColor="#666" />
                            <DatePicker
                                x:Name="CheckOutPicker"
                                DateSelected="OnDateSelected"
                                FontSize="16"
                                Format="dd/MM/yyyy"
                                MinimumDate="11/26/2025" />
                        </VerticalStackLayout>

                        <!--  NÃºmero de noches  -->
                        <Frame
                            Padding="15"
                            BackgroundColor="#F0E6FF"
                            CornerRadius="10"
                            HasShadow="False">
                            <HorizontalStackLayout Spacing="10">
                                <Label FontSize="18" Text="ðŸŒ™" />
                                <Label
                                    x:Name="NightsLabel"
                                    FontSize="14"
                                    Text="Selecciona las fechas"
                                    TextColor="#6200EA"
                                    VerticalOptions="Center" />
                            </HorizontalStackLayout>
                        </Frame>
                    </VerticalStackLayout>
                </Frame>

                <!--  NÃºmero de huÃ©spedes  -->
                <Frame
                    Padding="20"
                    BackgroundColor="White"
                    CornerRadius="15"
                    HasShadow="True">
                    <VerticalStackLayout Spacing="10">
                        <Label
                            FontAttributes="Bold"
                            FontSize="16"
                            Text="NÃºmero de huÃ©spedes"
                            TextColor="#333" />

                        <Grid ColumnDefinitions="*,Auto,Auto,Auto">
                            <Label
                                FontSize="14"
                                Text="Adultos"
                                TextColor="#666"
                                VerticalOptions="Center" />

                            <Button
                                Grid.Column="1"
                                Padding="0"
                                BackgroundColor="#F5F5F5"
                                Clicked="OnDecreaseGuests"
                                CornerRadius="20"
                                FontSize="20"
                                HeightRequest="40"
                                Text="-"
                                TextColor="#333"
                                WidthRequest="40" />

                            <Label
                                x:Name="GuestsLabel"
                                Grid.Column="2"
                                FontAttributes="Bold"
                                FontSize="18"
                                HorizontalTextAlignment="Center"
                                Text="2"
                                TextColor="#333"
                                VerticalOptions="Center"
                                WidthRequest="40" />

                            <Button
                                Grid.Column="3"
                                Padding="0"
                                BackgroundColor="#6200EA"
                                Clicked="OnIncreaseGuests"
                                CornerRadius="20"
                                FontSize="20"
                                HeightRequest="40"
                                Text="+"
                                TextColor="White"
                                WidthRequest="40" />
                        </Grid>

                        <Label
                            x:Name="MaxGuestsWarning"
                            FontSize="12"
                            IsVisible="False"
                            Text="MÃ¡ximo permitido para esta habitaciÃ³n"
                            TextColor="#FF9800" />
                    </VerticalStackLayout>
                </Frame>

                <!--  Solicitudes especiales  -->
                <Frame
                    Padding="20"
                    BackgroundColor="White"
                    CornerRadius="15"
                    HasShadow="True">
                    <VerticalStackLayout Spacing="10">
                        <Label
                            FontAttributes="Bold"
                            FontSize="16"
                            Text="Solicitudes especiales (opcional)"
                            TextColor="#333" />
                        <Label
                            FontSize="12"
                            Text="Ej: HabitaciÃ³n en piso alto, cuna para bebÃ©, almohadas extra"
                            TextColor="#999" />
                        <Editor
                            x:Name="SpecialRequestsEditor"
                            FontSize="14"
                            HeightRequest="100"
                            Placeholder="Escribe aquÃ­ tus solicitudes..." />
                    </VerticalStackLayout>
                </Frame>

                <!--  Resumen de precios  -->
                <Frame
                    x:Name="PriceSummary"
                    Padding="20"
                    BackgroundColor="White"
                    CornerRadius="15"
                    HasShadow="True"
                    IsVisible="False">
                    <VerticalStackLayout Spacing="10">
                        <Label
                            Margin="0,0,0,10"
                            FontAttributes="Bold"
                            FontSize="16"
                            Text="Resumen de precios"
                            TextColor="#333" />

                        <!--  Subtotal  -->
                        <Grid ColumnDefinitions="*,Auto">
                            <Label
                                x:Name="SubtotalDescLabel"
                                FontSize="14"
                                Text="$228 x 1 noche"
                                TextColor="#666" />
                            <Label
                                x:Name="SubtotalLabel"
                                Grid.Column="1"
                                FontSize="14"
                                Text="$228.00"
                                TextColor="#333" />
                        </Grid>

                        <!--  Impuestos  -->
                        <Grid ColumnDefinitions="*,Auto">
                            <Label
                                FontSize="14"
                                Text="Impuestos y cargos (13%)"
                                TextColor="#666" />
                            <Label
                                x:Name="TaxesLabel"
                                Grid.Column="1"
                                FontSize="14"
                                Text="$29.64"
                                TextColor="#333" />
                        </Grid>

                        <!--  Cargo por servicio  -->
                        <Grid ColumnDefinitions="*,Auto">
                            <Label
                                FontSize="14"
                                Text="Cargo por servicio"
                                TextColor="#666" />
                            <Label
                                x:Name="ServiceFeeLabel"
                                Grid.Column="1"
                                FontSize="14"
                                Text="$10.00"
                                TextColor="#333" />
                        </Grid>

                        <BoxView
                            Margin="0,10"
                            BackgroundColor="#EEEEEE"
                            HeightRequest="1" />

                        <!--  Total  -->
                        <Grid ColumnDefinitions="*,Auto">
                            <Label
                                FontAttributes="Bold"
                                FontSize="18"
                                Text="Total"
                                TextColor="#333" />
                            <Label
                                x:Name="TotalLabel"
                                Grid.Column="1"
                                FontAttributes="Bold"
                                FontSize="20"
                                Text="$267.64"
                                TextColor="#6200EA" />
                        </Grid>
                    </VerticalStackLayout>
                </Frame>

            </VerticalStackLayout>
        </ScrollView>

        <!--  Footer con botÃ³n  -->
        <Frame
            Grid.Row="2"
            Padding="20"
            BackgroundColor="White"
            CornerRadius="0"
            HasShadow="True">
            <Button
                x:Name="ConfirmButton"
                Padding="0,15"
                BackgroundColor="#6200EA"
                Clicked="OnConfirmBookingClicked"
                CornerRadius="15"
                FontAttributes="Bold"
                FontSize="16"
                IsEnabled="False"
                Text="Confirmar ReservaciÃ³n"
                TextColor="White" />
        </Frame>

    </Grid>
</ContentPage>